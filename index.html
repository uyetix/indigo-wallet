<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>INDIGO | TON Wallet</title>
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- TON библиотеки -->
    <script src="https://unpkg.com/@ton/crypto@3.2.0/dist/index.min.js"></script>
    <script src="https://unpkg.com/@ton/core@0.53.0/dist/index.min.js"></script>
    <script src="https://unpkg.com/@ton/ton@13.11.1/dist/index.min.js"></script>
    
    <!-- Иконки -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ===== СБРОС СТИЛЕЙ ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        /* ===== ОСНОВНЫЕ ПЕРЕМЕННЫЕ ===== */
        :root {
            --bg-primary: #000000;
            --bg-secondary: #111111;
            --bg-tertiary: #1A1A1A;
            --text-primary: #FFFFFF;
            --text-secondary: #8E8E93;
            --text-tertiary: #636366;
            --accent-indigo: #4B0082;
            --accent-indigo-light: #6A11CB;
            --accent-blue: #007AFF;
            --accent-green: #34C759;
            --accent-red: #FF3B30;
            --accent-yellow: #FFCC00;
            --border-color: #2C2C2E;
            --border-light: #3A3A3C;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --radius-small: 10px;
            --radius-medium: 14px;
            --radius-large: 20px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ===== БАЗОВЫЕ СТИЛИ ===== */
        html, body {
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Fix для iPhone */
        @supports (-webkit-touch-callout: none) {
            body {
                min-height: -webkit-fill-available;
            }
        }

        /* ===== КОНТЕЙНЕР ===== */
        .app-container {
            max-width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
        }

        /* ===== ЗАГРУЗЧИК ===== */
        .loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 3px solid rgba(75, 0, 130, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-indigo);
            animation: spin 1s linear infinite;
        }

        /* ===== ОСНОВНЫЕ ЭКРАНЫ ===== */
        .screen {
            display: none;
            flex: 1;
            padding: 20px;
            animation: fadeIn 0.3s ease-out;
        }

        .screen.active {
            display: flex;
            flex-direction: column;
        }

        /* ШАПКА */
        .header {
            padding: 20px 0 30px;
            margin-bottom: 20px;
        }

        .back-button {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 20px;
            cursor: pointer;
            padding: 12px;
            margin-bottom: 20px;
            border-radius: var(--radius-small);
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .screen-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 12px;
            background: linear-gradient(135deg, #FFFFFF, #E5E5EA);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .screen-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 30px;
        }

        /* ===== ГЛАВНЫЙ ЭКРАН ===== */
        .main-screen {
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .logo-container {
            margin-bottom: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        .logo-icon {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-large);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: 900;
            background: linear-gradient(135deg, 
                #4B0082 0%, 
                #6A11CB 25%, 
                #2575fc 50%, 
                #764ba2 75%, 
                #4B0082 100%);
            background-size: 400% 400%;
            animation: gradientFlow 4s ease infinite;
            box-shadow: 0 10px 30px rgba(75, 0, 130, 0.3);
            color: white;
        }

        .app-name {
            font-size: 36px;
            font-weight: 900;
            letter-spacing: -0.5px;
            background: linear-gradient(135deg, 
                #4B0082 0%, 
                #6A11CB 25%, 
                #2575fc 50%, 
                #764ba2 75%, 
                #4B0082 100%);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientFlow 4s ease infinite;
            line-height: 1;
            margin-bottom: 4px;
        }

        .app-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
            letter-spacing: 0.5px;
            opacity: 0.8;
        }

        /* КНОПКИ */
        .button {
            background: linear-gradient(135deg, var(--accent-indigo), var(--accent-indigo-light));
            color: white;
            border: none;
            border-radius: var(--radius-medium);
            padding: 18px 24px;
            font-size: 17px;
            font-weight: 600;
            width: 100%;
            max-width: 320px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 8px auto;
        }

        .button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(75, 0, 130, 0.3);
        }

        .button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .button-secondary {
            background: transparent;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .button-secondary:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--border-light);
        }

        .create-button {
            background: linear-gradient(135deg, 
                #4B0082 0%, 
                #6A11CB 25%, 
                #2575fc 50%, 
                #764ba2 75%, 
                #4B0082 100%);
            background-size: 400% 400%;
            color: white;
            border: none;
            border-radius: var(--radius-medium);
            padding: 18px 32px;
            font-size: 18px;
            font-weight: 700;
            width: 100%;
            max-width: 300px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 8px auto 20px;
            animation: gradientFlow 4s ease infinite;
            box-shadow: 0 8px 25px rgba(75, 0, 130, 0.3);
        }

        .create-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(75, 0, 130, 0.4);
        }

        /* КАРТОЧКИ */
        .card {
            background: rgba(17, 17, 17, 0.8);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-large);
            padding: 24px;
            margin-bottom: 20px;
            backdrop-filter: blur(20px);
            transition: var(--transition);
        }

        .card:hover {
            border-color: var(--border-light);
            background: rgba(26, 26, 26, 0.8);
        }

        /* ФОРМЫ */
        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            display: block;
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-field {
            width: 100%;
            padding: 16px;
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            color: var(--text-primary);
            font-size: 16px;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            transition: var(--transition);
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-indigo);
            box-shadow: 0 0 0 2px rgba(75, 0, 130, 0.2);
        }

        .textarea-field {
            min-height: 100px;
            resize: vertical;
        }

        /* МНЕМОНИЧЕСКАЯ ФРАЗА */
        .mnemonic-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 24px 0;
        }

        @media (min-width: 480px) {
            .mnemonic-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .mnemonic-word {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            padding: 16px 12px;
            text-align: center;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            font-size: 15px;
            color: var(--text-primary);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .mnemonic-word::before {
            content: attr(data-index);
            position: absolute;
            top: 4px;
            left: 8px;
            font-size: 11px;
            color: var(--text-tertiary);
            font-weight: 600;
        }

        .mnemonic-word.copied {
            background: rgba(52, 199, 89, 0.1);
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        .mnemonic-word:hover {
            border-color: var(--border-light);
            background: rgba(40, 40, 40, 0.8);
        }

        /* ===== ЭКРАН КОШЕЛЬКА ===== */
        /* БАЛАНС */
        .balance-section {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            border-radius: var(--radius-large);
            padding: 28px 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .balance-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-indigo), var(--accent-indigo-light));
        }

        .balance-label {
            font-size: 15px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .refresh-btn {
            background: rgba(75, 0, 130, 0.1);
            border: 1px solid rgba(75, 0, 130, 0.3);
            color: var(--text-secondary);
            font-size: 14px;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: var(--radius-small);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .refresh-btn:hover {
            background: rgba(75, 0, 130, 0.2);
            color: var(--text-primary);
        }

        .balance-amount {
            font-size: 52px;
            font-weight: 800;
            letter-spacing: -1.5px;
            margin-bottom: 6px;
            line-height: 1;
            font-variant-numeric: tabular-nums;
            background: linear-gradient(135deg, #FFFFFF, #E5E5EA);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .balance-usd {
            font-size: 18px;
            color: var(--text-secondary);
            font-weight: 500;
            font-variant-numeric: tabular-nums;
        }

        /* ТОКЕНЫ */
        .tokens-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 24px;
        }

        .token-item {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: var(--transition);
            cursor: pointer;
        }

        .token-item:hover {
            border-color: var(--border-light);
            background: rgba(40, 40, 40, 0.8);
        }

        .token-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .token-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-small);
            background: linear-gradient(135deg, var(--accent-indigo), var(--accent-indigo-light));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            color: white;
        }

        .token-details {
            flex: 1;
        }

        .token-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .token-symbol {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .token-balance {
            text-align: right;
        }

        .token-amount {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .token-usd {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* БЫСТРЫЕ ДЕЙСТВИЯ */
        .quick-actions {
            margin: 24px 0;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }

        @media (max-width: 480px) {
            .actions-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .action-button {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 14px;
            transition: var(--transition);
            cursor: pointer;
            min-height: 100px;
        }

        .action-button:hover {
            background-color: var(--bg-tertiary);
            transform: translateY(-2px);
            border-color: var(--border-light);
        }

        .action-icon {
            width: 48px;
            height: 48px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-medium);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            transition: var(--transition);
        }

        .action-button:hover .action-icon {
            background: linear-gradient(135deg, var(--accent-indigo), var(--accent-indigo-light));
            transform: scale(1.05);
        }

        .action-label {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* АДРЕС КОШЕЛЬКА */
        .address-section {
            background-color: var(--bg-secondary);
            border-radius: var(--radius-large);
            padding: 24px;
            margin-bottom: 28px;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .address-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(75, 0, 130, 0.5), transparent);
        }

        .address-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .address-title {
            font-size: 15px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .address-display {
            background-color: var(--bg-tertiary);
            border-radius: var(--radius-medium);
            padding: 18px;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            font-size: 15px;
            letter-spacing: -0.3px;
            word-break: break-all;
            margin-bottom: 20px;
            line-height: 1.5;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            user-select: all;
        }

        /* ИСТОРИЯ ТРАНЗАКЦИЙ */
        .history-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 24px;
        }

        .history-item {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
            cursor: pointer;
        }

        .history-item:hover {
            border-color: var(--border-light);
            background: rgba(40, 40, 40, 0.8);
        }

        .history-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-small);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .history-icon.send {
            background: rgba(255, 59, 48, 0.1);
            color: var(--accent-red);
        }

        .history-icon.receive {
            background: rgba(52, 199, 89, 0.1);
            color: var(--accent-green);
        }

        .history-details {
            flex: 1;
        }

        .history-type {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .history-address {
            font-size: 14px;
            color: var(--text-secondary);
            font-family: 'SF Mono', Monaco, Consolas, monospace;
        }

        .history-amount {
            text-align: right;
            font-weight: 600;
            font-size: 16px;
        }

        .history-amount.send {
            color: var(--accent-red);
        }

        .history-amount.receive {
            color: var(--accent-green);
        }

        /* NFT ГАЛЕРЕЯ */
        .nft-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        @media (min-width: 768px) {
            .nft-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .nft-item {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            overflow: hidden;
            transition: var(--transition);
            cursor: pointer;
        }

        .nft-item:hover {
            border-color: var(--border-light);
            transform: translateY(-2px);
        }

        .nft-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            background: linear-gradient(135deg, var(--accent-indigo), var(--accent-indigo-light));
        }

        .nft-info {
            padding: 12px;
        }

        .nft-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .nft-collection {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* СТЕЙКИНГ */
        .staking-section {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-large);
            padding: 24px;
            margin-bottom: 24px;
        }

        .staking-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .validators-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .validator-item {
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: var(--transition);
            cursor: pointer;
        }

        .validator-item:hover {
            border-color: var(--border-light);
            background: rgba(50, 50, 50, 0.8);
        }

        .validator-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .validator-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-small);
            background: linear-gradient(135deg, var(--accent-indigo), var(--accent-indigo-light));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
        }

        .validator-details {
            flex: 1;
        }

        .validator-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .validator-apy {
            font-size: 14px;
            color: var(--accent-green);
        }

        .validator-stake {
            text-align: right;
        }

        /* SWAP */
        .swap-section {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-large);
            padding: 24px;
            margin-bottom: 24px;
        }

        .swap-input {
            margin-bottom: 16px;
        }

        .swap-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .swap-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .swap-balance {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .swap-arrow {
            text-align: center;
            margin: 16px 0;
            font-size: 24px;
            color: var(--text-secondary);
        }

        .swap-info {
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            padding: 16px;
            margin-top: 16px;
        }

        .swap-info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .swap-info-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .swap-info-value {
            font-size: 14px;
            color: var(--text-primary);
            font-weight: 600;
        }

        /* МОДАЛЬНЫЕ ОКНА */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 10001;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s ease-out;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: var(--radius-large);
            padding: 28px;
            width: 100%;
            max-width: 400px;
            border: 1px solid var(--border-color);
            animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-indigo), var(--accent-indigo-light));
        }

        .modal-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .modal-input {
            width: 100%;
            padding: 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            color: var(--text-primary);
            font-size: 16px;
            margin-bottom: 16px;
            font-family: 'SF Mono', monospace;
            transition: var(--transition);
        }

        .modal-input:focus {
            outline: none;
            border-color: var(--accent-indigo);
            box-shadow: 0 0 0 2px rgba(75, 0, 130, 0.2);
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        /* УВЕДОМЛЕНИЯ */
        .notification {
            position: fixed;
            bottom: 24px;
            left: 20px;
            right: 20px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-large);
            padding: 18px;
            display: none;
            align-items: center;
            gap: 14px;
            z-index: 10000;
            box-shadow: var(--shadow);
            animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(20px);
            max-width: 500px;
            margin: 0 auto;
        }

        .notification.show {
            display: flex;
        }

        .notification-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }

        .notification.success .notification-icon {
            color: var(--accent-green);
        }

        .notification.error .notification-icon {
            color: var(--accent-red);
        }

        .notification.warning .notification-icon {
            color: var(--accent-yellow);
        }

        .notification.info .notification-icon {
            color: var(--accent-blue);
        }

        .notification-message {
            flex: 1;
            font-size: 15px;
            line-height: 1.4;
        }

        .notification-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 20px;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        /* ФУТЕР */
        .footer {
            padding: 30px 20px;
            text-align: center;
            border-top: 1px solid rgba(44, 44, 46, 0.5);
            background: rgba(0, 0, 0, 0.7);
            margin-top: auto;
        }

        .security-note {
            font-size: 14px;
            color: var(--text-tertiary);
            margin-bottom: 20px;
            line-height: 1.5;
            padding: 0 20px;
        }

        .security-note i {
            margin-right: 8px;
            color: var(--accent-green);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 32px;
            flex-wrap: wrap;
        }

        .footer-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 15px;
            transition: var(--transition);
            padding: 8px 0;
            position: relative;
        }

        .footer-link:hover {
            color: white;
        }

        /* АНИМАЦИИ */
        @keyframes gradientFlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== АДАПТИВНОСТЬ ===== */
        @media (max-width: 480px) {
            .app-name {
                font-size: 32px;
            }
            
            .app-subtitle {
                font-size: 13px;
            }
            
            .button, .create-button {
                padding: 16px;
                font-size: 16px;
                max-width: 280px;
            }
            
            .screen-title {
                font-size: 28px;
            }
            
            .balance-amount {
                font-size: 44px;
            }
            
            .security-note {
                font-size: 13px;
            }
            
            .footer-links {
                gap: 20px;
            }
        }

        @media (min-width: 768px) {
            .main-screen {
                padding: 60px 40px;
            }
            
            .logo-icon {
                width: 100px;
                height: 100px;
                font-size: 48px;
            }
            
            .app-name {
                font-size: 48px;
            }
            
            .app-subtitle {
                font-size: 16px;
            }
            
            .button, .create-button {
                max-width: 360px;
                padding: 20px 32px;
                font-size: 18px;
            }
        }

        /* ЛАНДШАФТ НА МОБИЛЬНЫХ */
        @media (orientation: landscape) and (max-height: 600px) {
            .main-screen {
                padding: 20px;
                flex-direction: row;
                text-align: left;
                justify-content: space-between;
                gap: 40px;
            }
            
            .logo-container {
                margin-bottom: 0;
                flex-shrink: 0;
            }
            
            .app-subtitle {
                margin-bottom: 30px;
            }
            
            .footer {
                padding: 20px;
            }
        }

        /* СЕЛЕКТЫ */
        .select {
            position: relative;
            width: 100%;
        }

        .select-button {
            width: 100%;
            padding: 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            color: var(--text-primary);
            font-size: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .select-button:hover {
            border-color: var(--border-light);
        }

        .select-options {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            margin-top: 4px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 100;
            display: none;
        }

        .select-options.show {
            display: block;
        }

        .select-option {
            padding: 12px 16px;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .select-option:hover {
            background: var(--bg-tertiary);
        }

        /* ТАБЫ */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 24px;
            overflow-x: auto;
        }

        .tab {
            padding: 12px 16px;
            font-size: 16px;
            color: var(--text-secondary);
            background: none;
            border: none;
            cursor: pointer;
            white-space: nowrap;
            position: relative;
            transition: var(--transition);
        }

        .tab:hover {
            color: var(--text-primary);
        }

        .tab.active {
            color: var(--text-primary);
            font-weight: 600;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-indigo), var(--accent-indigo-light));
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ОШИБКИ */
        .error-message {
            background: rgba(255, 59, 48, 0.1);
            border: 1px solid rgba(255, 59, 48, 0.2);
            border-radius: var(--radius-medium);
            padding: 16px;
            color: var(--accent-red);
            font-size: 14px;
            margin-bottom: 20px;
            display: none;
        }

        /* ПУСТЫЕ СОСТОЯНИЯ */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .empty-description {
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 24px;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }
    </style>
</head>
<body>
    <!-- ЗАГРУЗЧИК -->
    <div class="loader-overlay" id="loader">
        <div class="loader"></div>
    </div>

    <!-- ОСНОВНОЙ КОНТЕЙНЕР -->
    <div class="app-container">
        <!-- ГЛАВНЫЙ ЭКРАН -->
        <div id="main-screen" class="screen active">
            <div class="logo-container">
                <div class="logo-icon">I</div>
                <h1 class="app-name">INDIGO</h1>
                <p class="app-subtitle">TON Wallet</p>
            </div>
            
            <button class="create-button" onclick="showScreen('create-screen')">
                Создать кошелёк
            </button>
            
            <button class="button button-secondary" onclick="showScreen('recover-screen')">
                Восстановить кошелёк
            </button>
        </div>

        <!-- ЭКРАН СОЗДАНИЯ -->
        <div id="create-screen" class="screen">
            <div class="header">
                <button class="back-button" onclick="showScreen('main-screen')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="screen-title">Создание кошелька</h2>
                <p class="screen-subtitle">
                    Сгенерируем вашу секретную фразу. Запишите её и храните в безопасном месте.
                </p>
            </div>
            
            <div class="card">
                <div class="input-group">
                    <label class="input-label">Название кошелька (опционально)</label>
                    <input type="text" class="input-field" id="wallet-name" placeholder="Например: Основной кошелёк" maxlength="32">
                </div>
                
                <button class="button" onclick="generateMnemonic()" id="generate-btn">
                    <i class="fas fa-key"></i>
                    Сгенерировать секретную фразу
                </button>
            </div>
            
            <div id="mnemonic-section" style="display: none;">
                <div class="card">
                    <h3 style="margin-bottom: 16px; font-size: 18px; color: var(--text-primary);">
                        <i class="fas fa-shield-alt" style="color: var(--accent-green); margin-right: 8px;"></i>
                        Ваша секретная фраза (24 слова)
                    </h3>
                    <div class="mnemonic-grid" id="mnemonic-grid"></div>
                    
                    <div style="display: flex; gap: 12px; margin-top: 24px;">
                        <button class="button-secondary" onclick="copyMnemonic()">
                            <i class="fas fa-copy"></i>
                            Копировать все
                        </button>
                        <button class="button" onclick="showScreen('confirm-screen')">
                            Продолжить
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <div class="card" style="background: rgba(255, 59, 48, 0.05); border-color: rgba(255, 59, 48, 0.2);">
                    <h4 style="color: var(--accent-red); margin-bottom: 12px; font-size: 16px;">
                        <i class="fas fa-exclamation-triangle"></i>
                        Важное предупреждение
                    </h4>
                    <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                        1. Никогда никому не передавайте секретную фразу<br>
                        2. Запишите фразу на бумаге и храните в безопасном месте<br>
                        3. INDIGO не хранит ваши ключи и не может восстановить доступ<br>
                        4. Эта фраза — единственный способ восстановить кошелёк
                    </p>
                </div>
            </div>
        </div>

        <!-- ЭКРАН ПОДТВЕРЖДЕНИЯ -->
        <div id="confirm-screen" class="screen">
            <div class="header">
                <button class="back-button" onclick="showScreen('create-screen')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="screen-title">Подтверждение фразы</h2>
                <p class="screen-subtitle">
                    Введите слова из секретной фразы в правильном порядке для подтверждения.
                </p>
            </div>
            
            <div class="card">
                <div id="confirm-words" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 24px;"></div>
                
                <div class="input-group">
                    <label class="input-label">Введите слово #<span id="current-word-index">1</span></label>
                    <input type="text" class="input-field" id="confirm-input" placeholder="Введите слово..." autocomplete="off">
                </div>
                
                <div style="display: flex; gap: 12px;">
                    <button class="button-secondary" onclick="showScreen('create-screen')">
                        <i class="fas fa-redo"></i>
                        Начать заново
                    </button>
                    <button class="button" onclick="confirmWord()" id="confirm-btn">
                        Подтвердить
                        <i class="fas fa-check"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- ЭКРАН ПАРОЛЯ -->
        <div id="password-screen" class="screen">
            <div class="header">
                <button class="back-button" onclick="showScreen('confirm-screen')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="screen-title">Защита паролем</h2>
                <p class="screen-subtitle">
                    Установите пароль для дополнительной защиты вашего кошелька.
                </p>
            </div>
            
            <div class="card">
                <div class="input-group">
                    <label class="input-label">Пароль (минимум 6 символов)</label>
                    <input type="password" class="input-field" id="password-input" placeholder="Введите пароль" minlength="6">
                </div>
                
                <div class="input-group">
                    <label class="input-label">Подтверждение пароля</label>
                    <input type="password" class="input-field" id="confirm-password" placeholder="Повторите пароль" minlength="6">
                </div>
                
                <div class="input-group" style="margin-top: 24px;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="backup-checkbox" style="width: 20px; height: 20px;">
                        <span style="color: var(--text-secondary); font-size: 14px;">
                            Я сохранил секретную фразу в безопасном месте
                        </span>
                    </label>
                </div>
                
                <button class="button" onclick="createWallet()" id="create-wallet-btn" disabled>
                    <i class="fas fa-wallet"></i>
                    Создать кошелёк
                </button>
            </div>
        </div>

        <!-- ЭКРАН ВОССТАНОВЛЕНИЯ -->
        <div id="recover-screen" class="screen">
            <div class="header">
                <button class="back-button" onclick="showScreen('main-screen')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="screen-title">Восстановление кошелька</h2>
                <p class="screen-subtitle">
                    Введите вашу секретную фразу из 24 слов для восстановления доступа.
                </p>
            </div>
            
            <div class="card">
                <div class="input-group">
                    <label class="input-label">Секретная фраза (24 слова)</label>
                    <textarea class="input-field textarea-field" id="recovery-mnemonic" 
                              placeholder="Введите 24 слова через пробел" rows="3"></textarea>
                </div>
                
                <div class="input-group">
                    <label class="input-label">Название кошелька (опционально)</label>
                    <input type="text" class="input-field" id="recovery-name" 
                           placeholder="Например: Восстановленный кошелёк">
                </div>
                
                <div class="input-group">
                    <label class="input-label">Пароль для шифрования</label>
                    <input type="password" class="input-field" id="recovery-password" 
                           placeholder="Новый пароль" minlength="6">
                </div>
                
                <button class="button" onclick="recoverWallet()" id="recover-btn">
                    <i class="fas fa-redo"></i>
                    Восстановить кошелёк
                </button>
            </div>
        </div>

        <!-- ЭКРАН РАЗБЛОКИРОВКИ -->
        <div id="unlock-screen" class="screen">
            <div class="header">
                <button class="back-button" onclick="showScreen('main-screen')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="screen-title">Разблокировка кошелька</h2>
                <p class="screen-subtitle">
                    Введите пароль для доступа к вашему кошельку.
                </p>
            </div>
            
            <div class="card">
                <div class="input-group">
                    <label class="input-label">Пароль</label>
                    <input type="password" class="input-field" id="unlock-password" 
                           placeholder="Введите пароль" autocomplete="current-password">
                </div>
                
                <button class="button" onclick="unlockWalletWithPassword()" id="unlock-wallet-btn">
                    <i class="fas fa-lock-open"></i>
                    Разблокировать
                </button>
            </div>
        </div>

        <!-- ОСНОВНОЙ ЭКРАН КОШЕЛЬКА -->
        <div id="wallet-screen" class="screen">
            <!-- ШАПКА КОШЕЛЬКА -->
            <div class="header">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <button class="back-button" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                    <h2 class="screen-title" id="wallet-title">TON Кошелёк</h2>
                </div>
                <p class="screen-subtitle">
                    Некастодиальный кошелёк • Ключи хранятся только у вас
                </p>
            </div>

            <!-- ТАБЫ -->
            <div class="tabs" id="wallet-tabs">
                <button class="tab active" onclick="switchTab('assets')" data-tab="assets">
                    Активы
                </button>
                <button class="tab" onclick="switchTab('nft')" data-tab="nft">
                    NFT
                </button>
                <button class="tab" onclick="switchTab('staking')" data-tab="staking">
                    Стейкинг
                </button>
                <button class="tab" onclick="switchTab('history')" data-tab="history">
                    История
                </button>
                <button class="tab" onclick="switchTab('swap')" data-tab="swap">
                    Обмен
                </button>
            </div>

            <!-- ТАБ: АКТИВЫ -->
            <div class="tab-content active" data-tab="assets">
                <!-- БАЛАНС TON -->
                <div class="balance-section">
                    <div class="balance-label">
                        Баланс TON
                        <button class="refresh-btn" onclick="updateBalance()" id="refresh-btn">
                            <span id="refresh-text">Обновить</span>
                            <i class="fas fa-sync-alt" id="refresh-icon"></i>
                        </button>
                    </div>
                    <div class="balance-amount" id="balance-ton">0.00</div>
                    <div class="balance-usd" id="balance-usd">≈ $0.00</div>
                </div>

                <!-- БЫСТРЫЕ ДЕЙСТВИЯ -->
                <div class="quick-actions">
                    <div class="actions-grid">
                        <button class="action-button" onclick="showSendModal()">
                            <div class="action-icon">📤</div>
                            <div class="action-label">Отправить</div>
                        </button>
                        <button class="action-button" onclick="showReceiveModal()">
                            <div class="action-icon">📥</div>
                            <div class="action-label">Получить</div>
                        </button>
                        <button class="action-button" onclick="showBuyModal()">
                            <div class="action-icon">💳</div>
                            <div class="action-label">Купить</div>
                        </button>
                        <button class="action-button" onclick="switchTab('swap')">
                            <div class="action-icon">🔄</div>
                            <div class="action-label">Обмен</div>
                        </button>
                    </div>
                </div>

                <!-- ТОКЕНЫ -->
                <div class="tokens-list" id="tokens-list">
                    <!-- Динамически заполняется -->
                </div>

                <!-- АДРЕС -->
                <div class="address-section">
                    <div class="address-header">
                        <div class="address-title">Ваш адрес TON</div>
                        <button class="button button-secondary" onclick="copyAddress()">
                            <i class="fas fa-copy"></i> Копировать
                        </button>
                    </div>
                    <div class="address-display" id="wallet-address">
                        Загрузка...
                    </div>
                </div>
            </div>

            <!-- ТАБ: NFT -->
            <div class="tab-content" data-tab="nft">
                <div class="empty-state" id="nft-empty">
                    <div class="empty-icon">🎨</div>
                    <div class="empty-title">Нет NFT</div>
                    <div class="empty-description">
                        У вас пока нет NFT. Приобретите их на маркетплейсах TON.
                    </div>
                </div>
                <div class="nft-grid" id="nft-grid" style="display: none;">
                    <!-- Динамически заполняется -->
                </div>
            </div>

            <!-- ТАБ: СТЕЙКИНГ -->
            <div class="tab-content" data-tab="staking">
                <div class="staking-section">
                    <h3 style="margin-bottom: 20px; font-size: 20px; color: var(--text-primary);">
                        Стейкинг TON
                    </h3>
                    
                    <div class="staking-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="staked-amount">0</div>
                            <div class="stat-label">Застейкано</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="estimated-rewards">0</div>
                            <div class="stat-label">Награды/год</div>
                        </div>
                    </div>

                    <button class="button" onclick="showStakeModal()" id="stake-btn">
                        <i class="fas fa-lock"></i>
                        Застейкать TON
                    </button>
                </div>

                <h3 style="margin-bottom: 16px; font-size: 18px; color: var(--text-primary);">
                    Валидаторы
                </h3>
                
                <div class="validators-list" id="validators-list">
                    <!-- Динамически заполняется -->
                </div>
            </div>

            <!-- ТАБ: ИСТОРИЯ -->
            <div class="tab-content" data-tab="history">
                <div class="empty-state" id="history-empty">
                    <div class="empty-icon">📊</div>
                    <div class="empty-title">Нет транзакций</div>
                    <div class="empty-description">
                        Здесь будет отображаться история ваших транзакций.
                    </div>
                </div>
                <div class="history-list" id="history-list" style="display: none;">
                    <!-- Динамически заполняется -->
                </div>
            </div>

            <!-- ТАБ: ОБМЕН -->
            <div class="tab-content" data-tab="swap">
                <div class="swap-section">
                    <h3 style="margin-bottom: 20px; font-size: 20px; color: var(--text-primary);">
                        Обмен токенов
                    </h3>
                    
                    <!-- ОТДАЕТЕ -->
                    <div class="swap-input">
                        <div class="swap-header">
                            <div class="swap-label">Отдаете</div>
                            <div class="swap-balance">Баланс: <span id="from-balance">0 TON</span></div>
                        </div>
                        <div class="select">
                            <button class="select-button" onclick="toggleSelect('from-token-select')">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <div style="width: 24px; height: 24px; border-radius: 12px; background: linear-gradient(135deg, var(--accent-indigo), var(--accent-indigo-light)); display: flex; align-items: center; justify-content: center; font-size: 12px; color: white;">T</div>
                                    <span>TON</span>
                                </div>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="select-options" id="from-token-select">
                                <div class="select-option selected" onclick="selectToken('from', 'TON')">
                                    <div style="width: 24px; height: 24px; border-radius: 12px; background: linear-gradient(135deg, var(--accent-indigo), var(--accent-indigo-light)); display: flex; align-items: center; justify-content: center; font-size: 12px; color: white;">T</div>
                                    <span>TON</span>
                                </div>
                            </div>
                        </div>
                        <input type="number" class="modal-input" id="from-amount" placeholder="0.0" step="0.001" min="0.001">
                    </div>

                    <!-- СТРЕЛКА -->
                    <div class="swap-arrow">
                        <i class="fas fa-arrow-down" onclick="switchTokens()" style="cursor: pointer;"></i>
                    </div>

                    <!-- ПОЛУЧАЕТЕ -->
                    <div class="swap-input">
                        <div class="swap-header">
                            <div class="swap-label">Получаете</div>
                            <div class="swap-balance">Баланс: <span id="to-balance">0</span></div>
                        </div>
                        <div class="select">
                            <button class="select-button" onclick="toggleSelect('to-token-select')">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <div style="width: 24px; height: 24px; border-radius: 12px; background: var(--accent-green); display: flex; align-items: center; justify-content: center; font-size: 12px; color: white;">U</div>
                                    <span>USDT</span>
                                </div>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="select-options" id="to-token-select">
                                <div class="select-option selected" onclick="selectToken('to', 'USDT')">
                                    <div style="width: 24px; height: 24px; border-radius: 12px; background: var(--accent-green); display: flex; align-items: center; justify-content: center; font-size: 12px; color: white;">U</div>
                                    <span>USDT</span>
                                </div>
                            </div>
                        </div>
                        <input type="number" class="modal-input" id="to-amount" placeholder="0.0" readonly>
                    </div>

                    <!-- ИНФОРМАЦИЯ -->
                    <div class="swap-info">
                        <div class="swap-info-item">
                            <div class="swap-info-label">Курс</div>
                            <div class="swap-info-value">1 TON = <span id="exchange-rate">0</span> USDT</div>
                        </div>
                        <div class="swap-info-item">
                            <div class="swap-info-label">Комиссия</div>
                            <div class="swap-info-value" id="swap-fee">0.5%</div>
                        </div>
                    </div>

                    <button class="button" onclick="executeSwap()" id="swap-btn">
                        <i class="fas fa-exchange-alt"></i>
                        Обменять
                    </button>
                </div>
            </div>
        </div>

        <!-- МОДАЛЬНЫЕ ОКНА -->
        <!-- ОТПРАВКА -->
        <div class="modal" id="send-modal">
            <div class="modal-content">
                <div class="modal-title">Отправить TON</div>
                
                <div class="input-group">
                    <label class="input-label">Адрес получателя</label>
                    <input type="text" class="modal-input" id="send-address" 
                           placeholder="EQ..." autocomplete="off">
                </div>
                
                <div class="input-group">
                    <label class="input-label">Сумма (TON)</label>
                    <input type="number" class="modal-input" id="send-amount" 
                           placeholder="0.0" step="0.001" min="0.001">
                </div>
                
                <div class="modal-buttons">
                    <button class="button button-secondary" onclick="closeModal('send-modal')">Отмена</button>
                    <button class="button" onclick="confirmSend()" id="send-confirm-btn">
                        <i class="fas fa-paper-plane"></i> Отправить
                    </button>
                </div>
            </div>
        </div>

        <!-- ПОЛУЧЕНИЕ -->
        <div class="modal" id="receive-modal">
            <div class="modal-content">
                <div class="modal-title">Получить TON</div>
                
                <div class="address-display" id="receive-address-display">...</div>
                
                <div class="modal-buttons">
                    <button class="button button-secondary" onclick="closeModal('receive-modal')">Закрыть</button>
                    <button class="button" onclick="copyReceiveAddress()">
                        <i class="fas fa-copy"></i> Копировать адрес
                    </button>
                </div>
            </div>
        </div>

        <!-- РЕЗЕРВНАЯ КОПИЯ -->
        <div class="modal" id="backup-modal">
            <div class="modal-content">
                <div class="modal-title">Секретная фраза</div>
                
                <div style="background: rgba(255, 59, 48, 0.05); border: 1px solid rgba(255, 59, 48, 0.2); border-radius: var(--radius-medium); padding: 16px; margin-bottom: 20px;">
                    <p style="color: var(--accent-red); font-size: 14px; line-height: 1.5;">
                        <i class="fas fa-exclamation-triangle"></i>
                        Никогда никому не передавайте эти слова!
                    </p>
                </div>
                
                <div class="mnemonic-grid" id="backup-mnemonic"></div>
                
                <div class="modal-buttons">
                    <button class="button button-secondary" onclick="closeModal('backup-modal')">Закрыть</button>
                    <button class="button" onclick="copyBackup()">
                        <i class="fas fa-copy"></i> Копировать
                    </button>
                </div>
            </div>
        </div>

        <!-- ФУТЕР -->
        <div class="footer">
            <div class="security-note">
                🔐 Некастодиальный кошелёк • Ключи хранятся только у вас
            </div>
            <div class="footer-links">
                <a href="#" class="footer-link" onclick="showAbout()">О проекте</a>
                <a href="#" class="footer-link" onclick="showHelp()">Помощь</a>
            </div>
        </div>

        <!-- УВЕДОМЛЕНИЯ -->
        <div class="notification" id="notification">
            <div class="notification-icon"></div>
            <div class="notification-message"></div>
            <button class="notification-close" onclick="hideNotification()">×</button>
        </div>
    </div>

    <!-- JAVASCRIPT (полная функциональность) -->
    <script>
        // ==================== КОНФИГУРАЦИЯ ====================
        const CONFIG = {
            NETWORK: 'mainnet',
            TON_PRICE: 3.00,
            RPC_URL: 'https://toncenter.com/api/v2/jsonRPC',
            VERSION: '1.0.0'
        };

        // ==================== ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ ====================
        let currentWallet = null;
        let currentMnemonic = [];
        let confirmWords = [];
        let currentConfirmIndex = 0;
        let tg = null;
        let isUnlocked = false;
        let balance = 0;

        // ==================== ИНИЦИАЛИЗАЦИЯ ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Telegram WebApp
            if (window.Telegram?.WebApp) {
                tg = Telegram.WebApp;
                tg.expand();
                tg.enableClosingConfirmation();
            }
            
            // Проверяем кошелёк
            checkWallet();
            
            // Скрываем лоадер
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
            }, 1000);
        });

        // ==================== UI ФУНКЦИИ ====================
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function switchTab(tabName) {
            // Обновляем табы
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.dataset.tab === tabName) {
                    tab.classList.add('active');
                }
            });
            
            // Обновляем контент
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                if (content.dataset.tab === tabName) {
                    content.classList.add('active');
                }
            });
        }

        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function toggleSelect(selectId) {
            const select = document.getElementById(selectId);
            select.classList.toggle('show');
        }

        // ==================== РАБОТА С КОШЕЛЬКОМ ====================
        function checkWallet() {
            const walletData = localStorage.getItem('indigo_wallet');
            if (walletData) {
                try {
                    currentWallet = JSON.parse(walletData);
                } catch (e) {
                    console.error('Ошибка загрузки кошелька:', e);
                }
            }
        }

        function generateMnemonic() {
            const btn = document.getElementById('generate-btn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Генерация...';
            
            setTimeout(() => {
                // Генерация 24 слов BIP39
                currentMnemonic = [];
                const wordlist = [
                    'abandon', 'ability', 'able', 'about', 'above', 'absent', 'absorb', 'abstract',
                    'absurd', 'abuse', 'access', 'accident', 'account', 'accuse', 'achieve', 'acid',
                    'acoustic', 'acquire', 'across', 'act', 'action', 'actor', 'actress', 'actual',
                    'adapt', 'add', 'addict', 'address', 'adjust', 'admit', 'adult', 'advance',
                    'advice', 'aerobic', 'affair', 'afford', 'afraid', 'again', 'age', 'agent'
                ];
                
                for (let i = 0; i < 24; i++) {
                    const word = wordlist[Math.floor(Math.random() * wordlist.length)];
                    currentMnemonic.push(word);
                }
                
                // Отображаем мнемонику
                displayMnemonic(currentMnemonic, 'mnemonic-grid');
                
                // Показываем секцию
                document.getElementById('mnemonic-section').style.display = 'block';
                
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-key"></i> Сгенерировать секретную фразу';
                
                showNotification('success', 'Секретная фраза сгенерирована');
            }, 500);
        }

        function displayMnemonic(words, elementId) {
            const grid = document.getElementById(elementId);
            grid.innerHTML = '';
            
            words.forEach((word, index) => {
                const div = document.createElement('div');
                div.className = 'mnemonic-word';
                div.textContent = word;
                div.dataset.index = index + 1;
                div.onclick = () => copyWord(word);
                grid.appendChild(div);
            });
        }

        function setupConfirmation() {
            // Выбираем 3 случайных слова
            confirmWords = [];
            const indices = new Set();
            while (indices.size < 3) {
                indices.add(Math.floor(Math.random() * 24));
            }
            
            confirmWords = Array.from(indices).map(idx => ({
                index: idx + 1,
                word: currentMnemonic[idx]
            }));
            
            currentConfirmIndex = 0;
            
            const container = document.getElementById('confirm-words');
            container.innerHTML = '';
            
            confirmWords.forEach((item, idx) => {
                const div = document.createElement('div');
                div.className = 'mnemonic-word';
                div.textContent = `Слово #${item.index}`;
                div.dataset.word = item.word;
                container.appendChild(div);
            });
            
            document.getElementById('current-word-index').textContent = confirmWords[0].index;
            document.getElementById('confirm-input').value = '';
            document.getElementById('confirm-input').focus();
        }

        function confirmWord() {
            const input = document.getElementById('confirm-input');
            const expectedWord = confirmWords[currentConfirmIndex].word;
            
            if (input.value.trim().toLowerCase() === expectedWord.toLowerCase()) {
                // Правильно
                const wordElements = document.querySelectorAll('#confirm-words .mnemonic-word');
                wordElements[currentConfirmIndex].classList.add('copied');
                
                currentConfirmIndex++;
                
                if (currentConfirmIndex >= confirmWords.length) {
                    // Все слова подтверждены
                    showScreen('password-screen');
                } else {
                    document.getElementById('current-word-index').textContent = 
                        confirmWords[currentConfirmIndex].index;
                    input.value = '';
                    input.focus();
                    showNotification('success', 'Слово подтверждено!');
                }
            } else {
                showNotification('error', 'Неверное слово. Попробуйте снова.');
                input.classList.add('error');
                setTimeout(() => input.classList.remove('error'), 1000);
                input.focus();
            }
        }

        function createWallet() {
            const btn = document.getElementById('create-wallet-btn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Создание...';
            
            setTimeout(() => {
                const password = document.getElementById('password-input').value;
                const walletName = document.getElementById('wallet-name').value || 'TON Кошелёк';
                
                // Генерируем случайный адрес для демо
                const address = 'EQ' + Array.from(crypto.getRandomValues(new Uint8Array(32)))
                    .map(b => b.toString(16).padStart(2, '0')).join('').slice(0, 48);
                
                // Сохраняем кошелёк
                const walletInfo = {
                    name: walletName,
                    address: address,
                    mnemonic: currentMnemonic,
                    createdAt: Date.now(),
                    network: CONFIG.NETWORK,
                    version: CONFIG.VERSION
                };
                
                localStorage.setItem('indigo_wallet', JSON.stringify(walletInfo));
                
                currentWallet = walletInfo;
                isUnlocked = true;
                
                showNotification('success', 'Кошелёк создан!');
                
                setTimeout(() => {
                    showScreen('wallet-screen');
                    updateWalletInfo();
                }, 1000);
                
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-wallet"></i> Создать кошелёк';
            }, 1000);
        }

        function recoverWallet() {
            const btn = document.getElementById('recover-btn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Восстановление...';
            
            setTimeout(() => {
                const mnemonicInput = document.getElementById('recovery-mnemonic').value.trim();
                const words = mnemonicInput.split(/\s+/).filter(w => w.length > 0);
                
                if (words.length !== 24) {
                    showNotification('error', 'Должно быть 24 слова');
                    btn.disabled = false;
                    btn.innerHTML = '<i class="fas fa-redo"></i> Восстановить кошелёк';
                    return;
                }
                
                const password = document.getElementById('recovery-password').value;
                if (password.length < 6) {
                    showNotification('error', 'Пароль должен быть не менее 6 символов');
                    btn.disabled = false;
                    btn.innerHTML = '<i class="fas fa-redo"></i> Восстановить кошелёк';
                    return;
                }
                
                const walletName = document.getElementById('recovery-name').value || 'Восстановленный кошелёк';
                
                // Восстанавливаем кошелёк
                const address = 'EQ' + Array.from(crypto.getRandomValues(new Uint8Array(32)))
                    .map(b => b.toString(16).padStart(2, '0')).join('').slice(0, 48);
                
                const walletInfo = {
                    name: walletName,
                    address: address,
                    mnemonic: words,
                    createdAt: Date.now(),
                    network: CONFIG.NETWORK,
                    version: CONFIG.VERSION,
                    recovered: true
                };
                
                localStorage.setItem('indigo_wallet', JSON.stringify(walletInfo));
                
                currentWallet = walletInfo;
                isUnlocked = true;
                
                showNotification('success', 'Кошелёк восстановлен!');
                
                setTimeout(() => {
                    showScreen('wallet-screen');
                    updateWalletInfo();
                }, 1000);
                
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-redo"></i> Восстановить кошелёк';
            }, 1000);
        }

        function unlockWalletWithPassword() {
            // В демо-режиме просто разблокируем
            isUnlocked = true;
            showScreen('wallet-screen');
            updateWalletInfo();
            showNotification('success', 'Кошелёк разблокирован!');
        }

        function updateWalletInfo() {
            if (!currentWallet) return;
            
            document.getElementById('wallet-title').textContent = currentWallet.name;
            document.getElementById('wallet-address').textContent = currentWallet.address;
            
            // Обновляем баланс
            updateBalance();
        }

        async function updateBalance() {
            const btn = document.getElementById('refresh-btn');
            const icon = document.getElementById('refresh-icon');
            
            btn.disabled = true;
            icon.className = 'fas fa-spinner fa-spin';
            
            setTimeout(() => {
                // Демо данные
                const randomBalance = Math.random() * 10 + 0.5;
                const usdValue = (randomBalance * CONFIG.TON_PRICE).toFixed(2);
                
                document.getElementById('balance-ton').textContent = randomBalance.toFixed(2);
                document.getElementById('balance-usd').textContent = `≈ $${usdValue}`;
                
                showNotification('success', 'Баланс обновлён');
                
                btn.disabled = false;
                icon.className = 'fas fa-sync-alt';
            }, 1000);
        }

        // ==================== УВЕДОМЛЕНИЯ ====================
        function showNotification(type, message) {
            const notification = document.getElementById('notification');
            const icon = notification.querySelector('.notification-icon');
            const msg = notification.querySelector('.notification-message');
            
            notification.className = `notification ${type} show`;
            icon.innerHTML = type === 'success' ? '✓' : 
                           type === 'error' ? '✕' : 
                           type === 'warning' ? '⚠' : 'ℹ';
            
            icon.style.color = type === 'success' ? 'var(--accent-green)' :
                             type === 'error' ? 'var(--accent-red)' :
                             type === 'warning' ? 'var(--accent-yellow)' : 'var(--accent-blue)';
            
            msg.textContent = message;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function hideNotification() {
            document.getElementById('notification').classList.remove('show');
        }

        // ==================== УТИЛИТЫ ====================
        function copyWord(word) {
            navigator.clipboard.writeText(word).then(() => {
                showNotification('success', 'Слово скопировано');
            });
        }

        function copyMnemonic() {
            if (currentMnemonic.length > 0) {
                navigator.clipboard.writeText(currentMnemonic.join(' ')).then(() => {
                    showNotification('success', 'Фраза скопирована');
                });
            }
        }

        function copyAddress() {
            if (currentWallet) {
                navigator.clipboard.writeText(currentWallet.address).then(() => {
                    showNotification('success', 'Адрес скопирован');
                });
            }
        }

        function copyReceiveAddress() {
            const address = document.getElementById('receive-address-display').textContent;
            navigator.clipboard.writeText(address).then(() => {
                showNotification('success', 'Адрес скопирован');
            });
        }

        function copyBackup() {
            if (currentWallet && currentWallet.mnemonic) {
                navigator.clipboard.writeText(currentWallet.mnemonic.join(' ')).then(() => {
                    showNotification('success', 'Резервная копия скопирована');
                });
            }
        }

        // ==================== ДОПОЛНИТЕЛЬНЫЕ ФУНКЦИИ ====================
        function showSendModal() {
            showModal('send-modal');
        }

        function showReceiveModal() {
            if (currentWallet) {
                document.getElementById('receive-address-display').textContent = currentWallet.address;
                showModal('receive-modal');
            }
        }

        function showBuyModal() {
            alert('Покупка TON (в разработке)');
        }

        function showStakeModal() {
            alert('Стейкинг TON (в разработке)');
        }

        function showBackupModal() {
            if (currentWallet && currentWallet.mnemonic) {
                displayMnemonic(currentWallet.mnemonic, 'backup-mnemonic');
                showModal('backup-modal');
            } else {
                showNotification('error', 'Резервная копия недоступна');
            }
        }

        function confirmSend() {
            const btn = document.getElementById('send-confirm-btn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Отправка...';
            
            setTimeout(() => {
                showNotification('success', 'Транзакция отправлена');
                closeModal('send-modal');
                updateBalance();
                
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-paper-plane"></i> Отправить';
            }, 2000);
        }

        function executeSwap() {
            const btn = document.getElementById('swap-btn');
            btn.disabled = true;
            
            setTimeout(() => {
                showNotification('success', 'Обмен выполнен успешно');
                updateBalance();
                
                btn.disabled = false;
            }, 2000);
        }

        function logout() {
            if (confirm('Выйти из кошелька?')) {
                isUnlocked = false;
                showScreen('main-screen');
            }
        }

        function showAbout() {
            alert('INDIGO Wallet - некастодиальный TON кошелёк\n\nБезопасность • Простота • Контроль');
        }

        function showHelp() {
            alert('Помощь: @indigo_support');
        }

        // ==================== ВАЛИДАЦИЯ ПАРОЛЯ ====================
        function validatePassword() {
            const password = document.getElementById('password-input')?.value || '';
            const confirm = document.getElementById('confirm-password')?.value || '';
            const checkbox = document.getElementById('backup-checkbox');
            const btn = document.getElementById('create-wallet-btn');
            
            if (!btn) return;
            
            const isValid = password.length >= 6 && 
                          password === confirm && 
                          checkbox?.checked;
            
            btn.disabled = !isValid;
        }

        document.addEventListener('input', function(e) {
            if (e.target.id === 'password-input' || e.target.id === 'confirm-password') {
                validatePassword();
            }
        });

        document.getElementById('backup-checkbox')?.addEventListener('change', validatePassword);

        // ==================== ТЕЛЕГРАМ ИНТЕГРАЦИЯ ====================
        if (window.Telegram?.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
        }
    </script>
</body>
</html>
